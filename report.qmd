---
title: "The Measles Project"
subtitle: "Comparing Private & Public Schools"
format: html
editor: visual
execute:
  echo: true
---

```{r}
#| label: load-pkgs
#| message: false

library(tidyverse)
library(leaflet)
library(raster)
library(viridis)
```

## Introduction and Data

**Research question:** In 2018, how does the vaccination rate for measles differ across regions in the US? How do school districts in regions with high vaccination rates vs. low vaccination rates differ (public v. private, enrollment rate, type of geographical region - urban, rural)?

**Hypothesis:** Still working on this one - sigrid

**Note:**

We saw negative values, but we don't know what it means

Counties that don't report vaccination rates

**Motivation and Context**

The motivation for this project stemmed from the measles dataset from tidytuesday. It was interesting to see how the the data set categorically characertized the data. Our team imported the data into R and used the cateogires as a guide to make our plots and questions. The data as reported in the Wall Street Journal presents a map of measles vaccination rates in schools across the United States, showing that some schools have dangerously low vaccination rates, which increases the risk of measles outbreaks. The data is based on information from the 2018-2019 school year and includes public, private, and charter schools. According to the map, many of the schools with the lowest vaccination rates are in states such as Idaho, Utah, Colorado, and Oregon. The article also notes that measles cases have been on the rise in recent years, and emphasizes the importance of vaccination in preventing the spread of the highly contagious virus. Through this narrative and viewing the raw data we were able to form our hypothesis and question.

**Research question and Hypotheses**

**Ethical Issues**

Vaccination data is listed under HIPAA as protected health information and therefore cannot be shared without patient consent. In certain areas, vaccine data is not required for schools as well. The data may also be used to discriminate against certain areas unjustly. The sample population does not all benefit equally from our research.

**Citing Sources**

## Methodology

visualizations and summary statistics

```{r}
#| label: Data

measles <- readr::read_csv('data/measles.csv')

glimpse(measles)
```

```{r}
#| label: filtering-dataset

measles<- measles |>
  filter(!is.na(county)) |>
  filter(overall >= 0)
```

```{r}
USA <- getData("GADM", country = "usa", level = 2)

# Prepare data

mydata <- data.frame(state = c("Iowa", "Oklahoma"),
                     county = "Adair",
                     value = c(20, 100),
                     stringsAsFactors = FALSE)

# I do not know how your actual data is like. In this demonstration,
# I have data points for Adair in Iowa and Oklahoma. So 

temp <- merge(USA, mydata,
              by.x = c("NAME_1", "NAME_2"), by.y = c("state", "county"),
              all.x = TRUE)

# Create a color palette
mypal <- colorNumeric(palette = "viridis", domain = temp$value, na.color = "grey")

leaflet() |>
addProviderTiles("OpenStreetMap.Mapnik") |>
setView(lat = 39.8283, lng = -98.5795, zoom = 4) |>
addPolygons(data = USA, stroke = FALSE, smoothFactor = 0.2, fillOpacity = 0.3,
            fillColor = ~mypal(temp$value),
            popup = paste("Region: ", temp$NAME_2, "<br>",
                          "Value: ", temp$value, "<br>")) |>
addLegend(position = "bottomleft", pal = mypal, values = temp$value,
          title = "Value",
          opacity = 1)
```

scatter plot, points are states

tables of states

public vs private

state highest vs. lowest (county x, county y)

## Results

main results from your analysis
